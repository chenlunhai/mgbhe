<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta name="baidu-site-verification" content="brSKk1xvoHM7I577">
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<title>故障报修</title>
<link href="__PUBLIC__/css/style.css" rel="stylesheet" type="text/css">
</head>
<body style="background:#f0eff5">
<div class="warp">
	<div class="repair">
		<table cellpadding="0" cellspacing="0" border="0">
			<tr>
				<td class="bt">设备编号</td><td class="right">2017101900001</td>
			</tr>
			<tr>
				<td class="bt">经营地址</td><td class="right">湖南省长沙市雨花区湖南省长沙市雨</td>
			</tr>
			<tr>
            <td class="bt">故障问题</td><td class="right">
                <input type="text" class="w_input" name="repair" placeholder="请输入故障问题">
            </td>
          </tr>
			<tr>
				<td class="bt" valign="top" style="line-height:30px;">故障图片</td>
				<td class="right">
					<div class="r_t" id="delete">
		                <div class="img"><img src="__PUBLIC__/images/moren.png" id="img1"><input type="file" name="imgfile1" class="p_file"  id="imgfile1" onchange="showimg1($(this).parent())" /></div>
		            </div>

		            <div class="r_t" >
		                <div class="img"><img src="__PUBLIC__/images/moren.png" id="img2"><input type="file" name="imgfile2" class="p_file"  id="imgfile2" onchange="showimg2($(this).parent())" /></div>
		            </div>

		            <div class="r_t" >
		                <div class="img"><img src="__PUBLIC__/images/moren.png" id="img3"><input type="file" name="imgfile3" class="p_file"  id="imgfile3" onchange="showimg3($(this).parent())" /></div>
		            </div>
				</td>
			</tr>
		</table>
		<div class="re_tj"><a href="javascript:;" id="mes" onclick="verSubmit()">提交</a></div>
	</div>
</div>
<include file="Public/js" />
<!-- <script type="text/javascript" src="js/jquery.js"></script>
<script src="js/layer.js" type="text/javascript"></script> -->
<script type="text/javascript">
function deleteDiv1(obj) { 
  var html = '<div class="img"><img src="__PUBLIC__/images/moren.png" id="img1"><input type="file" name="imgfile1" class="p_file"  id="imgfile1" onchange="showimg1()" /></div>';
  obj.parent().html(html);
  obj.remove();
}
function deleteDiv2(obj) { 
  var html = '<div class="img"><img src="__PUBLIC__/images/moren.png" id="img2"><input type="file" name="imgfile2" class="p_file"  id="imgfile2" onchange="showimg2()" /></div>';
  obj.parent().html(html);
  obj.remove();
}
function deleteDiv3(obj) { 
  var html = '<div class="img"><img src="__PUBLIC__/images/moren.png" id="img3"><input type="file" name="imgfile3" class="p_file"  id="imgfile3" onchange="showimg3()" /></div>';
  obj.parent().html(html);
  obj.remove();
}
function showimg1(obj) {  
  var input_file = document.getElementById('imgfile1');
  var imgFile = new FileReader();  
  imgFile.readAsDataURL(input_file.files[0]);  
  imgFile.onload = function () {  
      $('#img1').attr('src',this.result); 
  }

  var html = '<div class="sc" onclick="deleteDiv1($(this).parent())">删除</div>';
  obj.append(html);
}
function showimg2(obj) {  
  var input_file = document.getElementById('imgfile2');
  var imgFile = new FileReader();  
  imgFile.readAsDataURL(input_file.files[0]);  
  imgFile.onload = function () {  
      $('#img2').attr('src',this.result); 
  }

  var html = '<div class="sc" onclick="deleteDiv2($(this).parent())">删除</div>';
  obj.append(html);
}
function showimg3(obj) {  
  var input_file = document.getElementById('imgfile3');
  var imgFile = new FileReader();  
  imgFile.readAsDataURL(input_file.files[0]);  
  imgFile.onload = function () {  
      $('#img3').attr('src',this.result); 
  }

  var html = '<div class="sc" onclick="deleteDiv3($(this).parent())">删除</div>';
  obj.append(html);
}

function  verSubmit() {
    var repair   = $.trim($('input[name=repair]').val());
    var out_trade_type = $('input[name=out_trade_type]:checked').val();
    var icon = 2;
    
    if(!repair){
      layer.msg('请输入故障问题', {
        icon: icon,
        shade: 0.5,
        time: 4000
      })
      return;
    }
    var checkimg = 0;
    $('.p_file').each(function(){
      if($(this).val()) checkimg = 1;
    })
    if(checkimg == 0){
      layer.msg('请至少上传一张票据', {
        icon: icon,
        shade: 0.5,
        time: 4000
      })
      return;
    }
}
</script>

</body>
</html>